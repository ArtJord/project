<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Painel do Tempo ‚è∞ ‚Äî Cart√≥rio Turbo</title>
<style>
  :root{
    --bg1:#0077cc; --bg2:#00c6ff;
    --fg:#ffffff; --card-bg:rgba(255,255,255,.12); --shadow:rgba(0,0,0,.25);
    --btn-bg:#ffffff; --btn-fg:#0077cc; --btn-bg-hover:#005fa3; --btn-fg-hover:#fff;
  }
  [data-theme="dark"]{
    --bg1:#1d1f20; --bg2:#444;
    --fg:#f3f3f3; --card-bg:rgba(255,255,255,.08); --shadow:rgba(0,0,0,.35);
    --btn-bg:#2b2d2f; --btn-fg:#eaeaea; --btn-bg-hover:#3a3d40; --btn-fg-hover:#fff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100vh; display:flex; align-items:center; justify-content:flex-start;
    flex-direction:column; gap:16px; text-align:center; color:var(--fg);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    background:linear-gradient(135deg,var(--bg1),var(--bg2)); transition:background .4s ease;
    padding:24px;
  }
  h1{margin:0; font-size:2rem; letter-spacing:.5px}
  .grid{ width:min(1200px,100%); display:grid; gap:16px; grid-template-columns:1fr; }
  @media (min-width: 1000px){ .grid{ grid-template-columns: repeat(3, 1fr);} .wide{grid-column: 1 / -1;} }
  .card{
    background:var(--card-bg); border-radius:16px; padding:18px;
    box-shadow:0 10px 24px var(--shadow); backdrop-filter: blur(6px);
  }
  #relogio{font-size:3.6rem; font-weight:800; letter-spacing:2px}
  #data{opacity:.95; font-size:1.1rem; margin-top:8px}
  .row{display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:12px}
  button,.switch{
    border:none; cursor:pointer; border-radius:12px; padding:10px 16px; font-weight:700;
    background:var(--btn-bg); color:var(--btn-fg); transition:.25s; user-select:none;
  }
  button:hover,.switch:hover{background:var(--btn-bg-hover); color:var(--btn-fg-hover)}
  input, textarea, select{
    width:100%; padding:10px 12px; border-radius:10px; border:1px solid transparent; outline:none;
    background:var(--card-bg); color:var(--fg);
  }
  textarea{min-height:120px; resize:vertical}
  .muted{opacity:.8}
  .title{font-weight:800; font-size:1.1rem; text-align:left}
  .mini-grid{display:grid; grid-template-columns:1fr 1fr; gap:8px}
  .mini{background:var(--card-bg); border-radius:12px; padding:10px}
  .time{font-size:1.35rem; font-weight:800}
  .small{font-size:.9rem}
  .pill{background:var(--card-bg); padding:6px 10px; border-radius:999px; font-weight:600}
  .kpi{display:flex; align-items:center; justify-content:center; gap:10px; flex-wrap:wrap}
  .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, monospace; background:var(--card-bg); padding:2px 6px; border-radius:6px}
  .col-2{display:grid; grid-template-columns:1fr 1fr; gap:8px}
  .right{ text-align:right }
</style>
</head>
<body>
  <h1>Painel do Tempo ‚è∞ ‚Äî Cart√≥rio Turbo</h1>

  <!-- Rel√≥gio principal -->
  <section class="card wide">
    <div id="relogio">00:00:00</div>
    <div id="data">‚Äî</div>
    <div class="row">
      <button id="btnTema" title="T">üåô Alternar Tema</button>
      <label class="switch"><input type="checkbox" id="chkAutoTema" /> Tema autom√°tico</label>
      <label class="switch"><input type="checkbox" id="chk12h" /> Formato 12h</label>
      <button id="btnCopiar" title="C">üìã Copiar hora</button>
      <button id="btnFull" title="F">‚õ∂ Tela cheia</button>
    </div>
    <div class="kpi" style="margin-top:10px">
      <span class="pill" id="saudacao">Ol√°! üëã</span>
      <span class="pill" id="semana">Semana ‚Äî</span>
      <span class="pill">Fuso: <span id="tz"></span></span>
    </div>
  </section>

  <section class="grid">
    <!-- Cron√¥metro -->
    <div class="card">
      <div class="title">Cron√¥metro ‚è±Ô∏è</div>
      <div id="cronometro" style="font-size:2rem; font-weight:800; margin:10px 0">00:00.00</div>
      <div class="row">
        <button id="startStop" title="Espa√ßo">Iniciar</button>
        <button id="lap" disabled title="L">Volta</button>
        <button id="reset" disabled title="R">Resetar</button>
      </div>
      <div id="voltas" class="muted small" style="margin-top:8px; max-height:120px; overflow:auto; text-align:left"></div>
    </div>

    <!-- Timer -->
    <div class="card">
      <div class="title">Timer ‚è≥</div>
      <div class="row">
        <input id="minutos" type="number" min="0" placeholder="Minutos" style="max-width:140px"/>
        <input id="segundos" type="number" min="0" max="59" placeholder="Segundos" style="max-width:140px"/>
      </div>
      <div id="mostraTimer" style="font-size:2rem; font-weight:800; margin:10px 0">00:00</div>
      <div class="row">
        <button id="timerStart">Come√ßar</button>
        <button id="timerPause" disabled>Pausar</button>
        <button id="timerReset" disabled>Resetar</button>
      </div>
      <p class="muted small">Dica: teste com 0m 10s üîî</p>
    </div>

    <!-- Pomodoro -->
    <div class="card">
      <div class="title">Pomodoro üçÖ</div>
      <div class="row">
        <input id="pomFocus" type="number" min="1" value="25" style="max-width:120px" />
        <input id="pomBreak" type="number" min="1" value="5" style="max-width:120px" />
        <select id="pomState" style="max-width:160px">
          <option value="focus">Foco</option>
          <option value="break">Pausa</option>
        </select>
      </div>
      <div id="pomDisplay" style="font-size:2rem; font-weight:800; margin:10px 0">25:00</div>
      <div class="row">
        <button id="pomStart">Iniciar</button>
        <button id="pomPause" disabled>Pausar</button>
        <button id="pomReset" disabled>Resetar</button>
      </div>
      <div class="muted small">Sess√µes conclu√≠das: <span id="pomSessions">0</span></div>
    </div>

    <!-- Rel√≥gios do mundo -->
    <div class="card">
      <div class="title">Rel√≥gios do Mundo üåç</div>
      <div class="mini-grid" id="worldClocks"></div>
      <p class="muted small" style="margin-top:8px">Atualiza a cada segundo.</p>
    </div>

    <!-- Notas -->
    <div class="card">
      <div class="title">Bloco de Notas üìù</div>
      <textarea id="notepad" placeholder="Escreva algo aqui... (salva automaticamente)"></textarea>
      <div class="row" style="margin-top:8px">
        <button id="clearNotes">Limpar notas</button>
        <span class="muted small" id="noteSaved">‚Äî</span>
      </div>
    </div>

    <!-- Diferen√ßa de datas -->
    <div class="card">
      <div class="title">Diferen√ßa de Datas üìÖ</div>
      <div class="row">
        <input type="date" id="d1" />
        <input type="date" id="d2" />
      </div>
      <div id="diffOut" style="margin-top:10px; font-weight:700">‚Äî</div>
      <button style="margin-top:8px" id="calcDiff">Calcular</button>
      <p class="muted small">Resultado em dias, horas e minutos.</p>
    </div>

    <!-- Dicas/Atalhos -->
    <div class="card">
      <div class="title">Atalhos de Teclado ‚å®Ô∏è</div>
      <ul class="small" style="text-align:left; margin:8px 0 0 16px">
        <li><span class="kbd">Espa√ßo</span> ‚Äî Iniciar/Pausar cron√¥metro</li>
        <li><span class="kbd">L</span> ‚Äî Marcar volta</li>
        <li><span class="kbd">R</span> ‚Äî Resetar cron√¥metro</li>
        <li><span class="kbd">T</span> ‚Äî Alternar tema</li>
        <li><span class="kbd">C</span> ‚Äî Copiar hora atual</li>
        <li><span class="kbd">F</span> ‚Äî Tela cheia</li>
      </ul>
    </div>

    <!-- Frase aleat√≥ria -->
    <div class="card">
      <div class="title">Frase do Momento ‚ú®</div>
      <div id="quote" style="margin-top:8px; font-size:1.05rem">Carregando‚Ä¶</div>
      <button style="margin-top:10px" id="newQuote">Trocar frase</button>
    </div>

    <!-- ===================== FERRAMENTAS DE CART√ìRIO ===================== -->
    <div class="card wide">
      <div class="title">Ferramentas de Cart√≥rio üèõÔ∏è</div>

      <!-- Linha 1: Extenso + CPF/CNPJ -->
      <div class="col-2" style="margin-top:10px">
        <div>
          <div class="small right muted">Valor por extenso (R$)</div>
          <input id="extensoValor" type="text" placeholder="Ex.: 4.637,13" />
          <div class="row">
            <button id="btnExtenso">Converter</button>
            <button id="btnCopyExtenso">Copiar</button>
          </div>
          <textarea id="extensoSaida" placeholder="Resultado por extenso..." readonly></textarea>
        </div>
        <div>
          <div class="small right muted">CPF/CNPJ ‚Äî validar e formatar</div>
          <input id="docNumero" type="text" placeholder="CPF ou CNPJ (s√≥ n√∫meros ou misto)" />
          <div class="row">
            <button id="btnValidarDoc">Validar</button>
            <button id="btnMaskDoc">Formatar</button>
            <button id="btnCopyDoc">Copiar</button>
          </div>
          <textarea id="docSaida" placeholder="Resultado da valida√ß√£o..." readonly></textarea>
        </div>
      </div>

      <!-- Linha 2: Qualifica√ß√£o r√°pida -->
      <div style="margin-top:12px">
        <div class="small right muted">Gerador de Qualifica√ß√£o</div>
        <div class="col-2">
          <input id="qNome" placeholder="Nome completo" />
          <input id="qCNH" placeholder="CNH n¬∞ (opcional)" />
          <input id="qRG" placeholder="RG n¬∞ + √ìrg√£o/UF (ex.: 1393735-SEJUSP/MS)" />
          <input id="qCPF" placeholder="CPF (s√≥ n√∫meros)" />
          <input id="qEndereco" placeholder="Endere√ßo (rua, n¬∫, bairro)" />
          <input id="qCidadeUF" placeholder="Cidade/UF" />
          <input id="qCEP" placeholder="CEP (ex.: 79805-031)" />
          <input id="qExpedicao" placeholder="Data expedi√ß√£o RG/CNH (ex.: 12/09/2022)" />
        </div>
        <div class="row">
          <button id="btnQualificar">Gerar par√°grafo</button>
          <button id="btnCopyQualif">Copiar</button>
        </div>
        <textarea id="qualifSaida" placeholder="Par√°grafo gerado..." readonly></textarea>
      </div>

      <!-- Linha 3: Prazos (dias √∫teis) -->
      <div style="margin-top:12px">
        <div class="small right muted">C√°lculo de prazo em dias √∫teis (ignora s√°b/dom + feriados informados)</div>
        <div class="col-2">
          <input id="pDataIni" type="date" />
          <input id="pDias" type="number" min="0" placeholder="Qtd dias √∫teis" />
        </div>
        <input id="pFeriados" type="text" placeholder="Feriados (YYYY-MM-DD, separados por v√≠rgula) ‚Äî ex.: 2025-11-02,2025-11-15" />
        <div class="row">
          <button id="btnPrazo">Calcular prazo</button>
          <button id="btnCopyPrazo">Copiar</button>
        </div>
        <textarea id="prazoSaida" placeholder="Data final e contagem..." readonly></textarea>
      </div>

      <!-- Linha 4: Modelos r√°pidos -->
      <div style="margin-top:12px">
        <div class="small right muted">Modelos r√°pidos (WhatsApp/E-mail)</div>
        <div class="col-2">
          <select id="modeloTipo">
            <option value="docs">Solicita√ß√£o de documentos</option>
            <option value="cobranca">Cobran√ßa com PIX (preferir QR do boleto)</option>
            <option value="matriculaOnr">Solicita√ß√£o de matr√≠cula ONR</option>
            <option value="cndIptu">CND/IPTU positiva ‚Äî orienta√ß√£o</option>
          </select>
          <input id="modeloNome" placeholder="Nome do destinat√°rio (opcional)" />
        </div>
        <div class="row">
          <button id="btnModelo">Gerar texto</button>
          <button id="btnCopyModelo">Copiar</button>
        </div>
        <textarea id="modeloSaida" placeholder="Texto gerado..." readonly></textarea>
        <p class="muted small">Obs.: Fecha sempre com ‚ÄúAtenciosamente, Cart√≥rio Vila S√£o Pedro | Dourados-MS üöÄ‚Äù.</p>
      </div>
    </div>
    <!-- =================== FIM FERRAMENTAS DE CART√ìRIO =================== -->
  </section>

<script>
  // ===== util/localStorage =====
  const store = {
    get(k, f){ try{return JSON.parse(localStorage.getItem(k)) ?? f}catch{return f} },
    set(k, v){ localStorage.setItem(k, JSON.stringify(v)) }
  };
  const two = n => n.toString().padStart(2,'0');

  // ===== tema & formato =====
  const chk12h = document.getElementById('chk12h');
  const chkAutoTema = document.getElementById('chkAutoTema');
  const btnTema = document.getElementById('btnTema');
  const btnCopiar = document.getElementById('btnCopiar');
  const btnFull = document.getElementById('btnFull');

  document.documentElement.setAttribute('data-theme', store.get('theme','light'));
  chk12h.checked = store.get('fmt12h', false);
  chkAutoTema.checked = store.get('autoTheme', true);

  function setTheme(theme){ document.documentElement.setAttribute('data-theme', theme); store.set('theme', theme); }
  function autoTheme(){
    if(!chkAutoTema.checked) return;
    const h = new Date().getHours();
    setTheme((h<6 || h>=18) ? 'dark' : 'light');
  }

  btnTema.onclick = () => {
    const cur = document.documentElement.getAttribute('data-theme');
    setTheme(cur === 'dark' ? 'light' : 'dark');
  };
  chk12h.onchange = () => store.set('fmt12h', chk12h.checked);
  chkAutoTema.onchange = () => store.set('autoTheme', chkAutoTema.checked);

  // ===== rel√≥gio principal =====
  const elRelogio = document.getElementById('relogio');
  const elData = document.getElementById('data');
  const elSaudacao = document.getElementById('saudacao');
  const elSemana = document.getElementById('semana');
  const elTZ = document.getElementById('tz');

  function formatClock(d){
    let h = d.getHours(), m = d.getMinutes(), s = d.getSeconds();
    if(chk12h.checked){
      const ampm = h>=12 ? 'PM':'AM';
      h = h%12 || 12;
      return `${two(h)}:${two(m)}:${two(s)} ${ampm}`;
    }
    return `${two(h)}:${two(m)}:${two(s)}`;
  }
  function weekNumber(d){
    const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
    const dayNum = date.getUTCDay() || 7;
    date.setUTCDate(date.getUTCDate() + 4 - dayNum);
    const yearStart = new Date(Date.UTC(date.getUTCFullYear(),0,1));
    return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);
  }
  function atualizarRelogio(){
    const now = new Date();
    elRelogio.textContent = formatClock(now);
    elData.textContent = now.toLocaleDateString('pt-BR', { weekday:'long', year:'numeric', month:'long', day:'numeric' });
    elSaudacao.textContent = now.getHours() < 12 ? 'Bom dia ‚òÄÔ∏è' : (now.getHours()<18 ? 'Boa tarde üå§Ô∏è' : 'Boa noite üåô');
    elSemana.textContent = `Semana ${weekNumber(now)} üìÖ`;
    elTZ.textContent = Intl.DateTimeFormat().resolvedOptions().timeZone;
    autoTheme();
  }
  setInterval(atualizarRelogio, 1000); atualizarRelogio();

  btnCopiar.onclick = async () => {
    try{
      await navigator.clipboard.writeText(elRelogio.textContent);
      btnCopiar.textContent = '‚úÖ Copiado!'; setTimeout(()=>btnCopiar.textContent='üìã Copiar hora', 900);
    }catch{ alert('N√£o foi poss√≠vel copiar.'); }
  };
  btnFull.onclick = () => {
    if (!document.fullscreenElement) document.documentElement.requestFullscreen?.();
    else document.exitFullscreen?.();
  };

  // ===== atalhos teclado =====
  window.addEventListener('keydown', (e)=>{
    if(['INPUT','TEXTAREA','SELECT'].includes(document.activeElement.tagName)) return;
    if(e.code==='Space'){ e.preventDefault(); document.getElementById('startStop').click(); }
    if(e.key.toLowerCase()==='l'){ document.getElementById('lap').click(); }
    if(e.key.toLowerCase()==='r'){ document.getElementById('reset').click(); }
    if(e.key.toLowerCase()==='t'){ btnTema.click(); }
    if(e.key.toLowerCase()==='c'){ btnCopiar.click(); }
    if(e.key.toLowerCase()==='f'){ btnFull.click(); }
  });

  // ===== cron√¥metro =====
  const elCron = document.getElementById('cronometro');
  const elVoltas = document.getElementById('voltas');
  const btnStartStop = document.getElementById('startStop');
  const btnLap = document.getElementById('lap');
  const btnReset = document.getElementById('reset');
  let cronRunning=false, cronStart=0, cronElapsed=0, cronInt=null, voltaCount=0;

  function renderCron(ms){
    const cs = Math.floor((ms % 1000) / 10);
    const s = Math.floor(ms/1000) % 60;
    const m = Math.floor(ms/60000);
    elCron.textContent = `${two(m)}:${two(s)}.${two(cs)}`;
  }
  function tickCron(){ renderCron(cronElapsed + (Date.now() - cronStart)); }
  btnStartStop.onclick = () => {
    if(!cronRunning){
      cronRunning = true; cronStart = Date.now();
      cronInt = setInterval(tickCron, 20);
      btnStartStop.textContent = 'Pausar';
      btnLap.disabled = false; btnReset.disabled = false;
    }else{
      cronRunning = false; clearInterval(cronInt);
      cronElapsed += Date.now() - cronStart;
      btnStartStop.textContent = 'Retomar';
    }
  };
  btnLap.onclick = () => {
    const ms = cronRunning ? (cronElapsed + (Date.now()-cronStart)) : cronElapsed;
    voltaCount++;
    const div = document.createElement('div');
    div.textContent = `Volta ${voltaCount}: ${elCron.textContent}`;
    elVoltas.prepend(div);
  };
  btnReset.onclick = () => {
    cronRunning=false; clearInterval(cronInt);
    cronElapsed=0; voltaCount=0; elVoltas.innerHTML=''; renderCron(0);
    btnStartStop.textContent='Iniciar'; btnLap.disabled=true; btnReset.disabled=true;
  };
  renderCron(0);

  // ===== timer =====
  const inMin = document.getElementById('minutos');
  const inSeg = document.getElementById('segundos');
  const elMostraTimer = document.getElementById('mostraTimer');
  const tStart = document.getElementById('timerStart');
  const tPause = document.getElementById('timerPause');
  const tReset = document.getElementById('timerReset');
  let tTotal=0, tRestante=0, tInt=null, tRodando=false;

  function renderTimer(sec){
    sec = Math.max(0, Math.floor(sec));
    const m = Math.floor(sec/60), s = sec%60;
    elMostraTimer.textContent = `${two(m)}:${two(s)}`;
  }
  function beep(){
    try{
      const ctx = new (window.AudioContext||window.webkitAudioContext)();
      const o = ctx.createOscillator(); const g = ctx.createGain();
      o.type='sine'; o.frequency.value=880; o.connect(g); g.connect(ctx.destination);
      g.gain.setValueAtTime(0.001, ctx.currentTime);
      g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime+0.01);
      o.start(); setTimeout(()=>{ g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.25); o.stop(ctx.currentTime+0.3); }, 250);
    }catch{}
  }
  function finishTimer(){ clearInterval(tInt); tRodando=false; renderTimer(0); tPause.disabled=true; beep(); alert('‚è≥ Tempo encerrado!'); }
  function tickTimer(){ tRestante -= 1; renderTimer(tRestante); if(tRestante<=0) finishTimer(); }
  tStart.onclick = () => {
    if(!tRodando){
      if(tRestante<=0){
        const m = Math.max(0, parseInt(inMin.value||'0',10));
        const s = Math.max(0, parseInt(inSeg.value||'0',10));
        tTotal = m*60 + s; tRestante = tTotal;
        if(tTotal===0){ alert('Defina um tempo üôÇ'); return; }
        renderTimer(tRestante);
      }
      tRodando=true; tInt=setInterval(tickTimer,1000);
      tPause.disabled=false; tReset.disabled=false;
    }
  };
  tPause.onclick = () => { if(tRodando){ clearInterval(tInt); tRodando=false; } else if(tRestante>0){ tRodando=true; tInt=setInterval(tickTimer,1000); } };
  tReset.onclick = () => { clearInterval(tInt); tRodando=false; tRestante=0; tTotal=0; renderTimer(0); tPause.disabled=true; tReset.disabled=true; };
  renderTimer(0);

  // ===== pomodoro =====
  const pomFocus = document.getElementById('pomFocus');
  const pomBreak = document.getElementById('pomBreak');
  const pomState = document.getElementById('pomState');
  const pomDisplay = document.getElementById('pomDisplay');
  const pomStart = document.getElementById('pomStart');
  const pomPause = document.getElementById('pomPause');
  const pomReset = document.getElementById('pomReset');
  const pomSessions = document.getElementById('pomSessions');

  let pRest=0, pInt=null, pRun=false, pSessions=store.get('pomSessions',0);
  pomSessions.textContent = pSessions;

  function setPomodoroTime(){
    const mins = (pomState.value==='focus') ? Number(pomFocus.value||25) : Number(pomBreak.value||5);
    pRest = Math.max(1, mins)*60;
    renderPom();
  }
  function renderPom(){
    const m=Math.floor(pRest/60), s=pRest%60;
    pomDisplay.textContent = `${two(m)}:${two(s)}`;
  }
  function tickPom(){
    pRest--; renderPom();
    if(pRest<=0){
      beep();
      if(pomState.value==='focus'){ pSessions++; store.set('pomSessions', pSessions); pomSessions.textContent=pSessions; pomState.value='break'; }
      else { pomState.value='focus'; }
      setPomodoroTime();
    }
  }
  pomStart.onclick=()=>{ if(!pRun){ if(pRest<=0) setPomodoroTime(); pRun=true; pInt=setInterval(tickPom,1000); pomPause.disabled=false; pomReset.disabled=false; } };
  pomPause.onclick=()=>{ if(pRun){ clearInterval(pInt); pRun=false; } else if(pRest>0){ pRun=true; pInt=setInterval(tickPom,1000); } };
  pomReset.onclick=()=>{ clearInterval(pInt); pRun=false; pRest=0; renderPom(); pomPause.disabled=true; pomReset.disabled=true; };
  pomState.onchange=setPomodoroTime; pomFocus.oninput=setPomodoroTime; pomBreak.oninput=setPomodoroTime; setPomodoroTime();

  // ===== world clocks =====
  const world = [
    {name:'Campo Grande', tz:'America/Campo_Grande'},
    {name:'S√£o Paulo', tz:'America/Sao_Paulo'},
    {name:'UTC', tz:'UTC'},
    {name:'Nova Iorque', tz:'America/New_York'},
    {name:'Londres', tz:'Europe/London'},
    {name:'T√≥quio', tz:'Asia/Tokyo'},
  ];
  const wc = document.getElementById('worldClocks');
  world.forEach(({name,tz})=>{
    const box=document.createElement('div'); box.className='mini';
    box.innerHTML = `<div class="small muted">${tz}</div><div class="time" data-tz="${tz}">--:--:--</div><div class="small">${name}</div>`;
    wc.appendChild(box);
  });
  function updateWorld(){
    const now=new Date();
    document.querySelectorAll('[data-tz]').forEach(el=>{
      const tz=el.getAttribute('data-tz');
      const s= now.toLocaleTimeString('pt-BR',{timeZone:tz, hour12:chk12h.checked});
      el.textContent=s;
    });
  }
  setInterval(updateWorld,1000); updateWorld();

  // ===== bloco de notas =====
  const notes = document.getElementById('notepad');
  const noteSaved = document.getElementById('noteSaved');
  notes.value = store.get('notes','');
  function markSaved(){ noteSaved.textContent = '‚úÖ salvo'; setTimeout(()=>noteSaved.textContent='‚Äî', 1000); }
  notes.addEventListener('input', ()=>{ store.set('notes', notes.value); markSaved(); });
  document.getElementById('clearNotes').onclick = ()=>{ if(confirm('Limpar notas?')){ notes.value=''; store.set('notes',''); markSaved(); } };

  // ===== diferen√ßa de datas =====
  function diffDates(a,b){
    const ms = Math.abs(b-a);
    const min = Math.floor(ms/60000);
    const horas = Math.floor(min/60);
    const dias = Math.floor(horas/24);
    return {dias, horas, min};
  }
  document.getElementById('calcDiff').onclick = ()=>{
    const d1=document.getElementById('d1').value;
    const d2=document.getElementById('d2').value;
    if(!d1 || !d2){ alert('Selecione as duas datas.'); return; }
    const {dias, horas, min} = diffDates(new Date(d1), new Date(d2));
    document.getElementById('diffOut').textContent = `${dias} dias | ${horas} horas | ${min} minutos`;
  };

  // ===== frases =====
  const quotes = [
    "Feito √© melhor que perfeito.",
    "Pequenos passos di√°rios constroem grandes resultados.",
    "Disciplina vence motiva√ß√£o.",
    "O melhor momento para come√ßar foi ontem. O segundo melhor √© agora.",
    "Foco no processo, n√£o no resultado."
  ];
  const quoteEl = document.getElementById('quote');
  function newQuote(){ quoteEl.textContent = quotes[Math.floor(Math.random()*quotes.length)]; }
  document.getElementById('newQuote').onclick = newQuote; newQuote();

  // =================== FERRAMENTAS DE CART√ìRIO (JS) ===================

  // --- Valor por extenso (R$) ---
  function parseCurrencyBRL(str){
    if(!str) return NaN;
    str = str.replace(/\s/g,'').replace(/\./g,'').replace(',', '.');
    return Number(str);
  }
  const UN = ["","um","dois","tr√™s","quatro","cinco","seis","sete","oito","nove","dez","onze","doze","treze","quatorze","quinze","dezesseis","dezessete","dezoito","dezenove"];
  const DEZ = ["","dez","vinte","trinta","quarenta","cinquenta","sessenta","setenta","oitenta","noventa"];
  const CEN = ["","cento","duzentos","trezentos","quatrocentos","quinhentos","seiscentos","setecentos","oitocentos","novecentos"];
  function extensoAte999(n){
    if(n===0) return "";
    if(n===100) return "cem";
    const c = Math.floor(n/100), d = Math.floor((n%100)/10), u = n%10, dez = n%100;
    let out=[];
    if(c) out.push(CEN[c]);
    if(dez){
      if(dez<20) out.push(UN[dez]);
      else{
        out.push(DEZ[d] + (u? " e "+UN[u]:""));
      }
    }
    return out.join(" e ");
  }
  function grupoNome(i, val){
    const sing = ["", "mil", "milh√£o", "bilh√£o", "trilh√£o"];
    const plur = ["", "mil", "milh√µes", "bilh√µes", "trilh√µes"];
    if(i===0) return "";
    return (val===1 ? sing[i] : plur[i]);
  }
  function numeroPorExtenso(n){
    if(n===0) return "zero";
    let partes=[]; let i=0;
    while(n>0){
      const g = n%1000;
      if(g){
        const texto = extensoAte999(g);
        const nome = grupoNome(i, g);
        let bloco = texto + (nome? " " + nome:"");
        partes.unshift(bloco);
      }
      n = Math.floor(n/1000); i++;
    }
    return partes.join(" ");
  }
  function moedaPorExtenso(valor){
    const inteiro = Math.floor(valor);
    const cent = Math.round((valor - inteiro)*100);
    let out=[];
    if(inteiro>0){
      const n = numeroPorExtenso(inteiro);
      out.push(n + " " + (inteiro===1? "real":"reais"));
    }
    if(cent>0){
      const c = numeroPorExtenso(cent);
      out.push(c + " " + (cent===1? "centavo":"centavos"));
    }
    return out.length? out.join(" e ") : "zero real";
  }
  const btnExtenso = document.getElementById('btnExtenso');
  const btnCopyExtenso = document.getElementById('btnCopyExtenso');
  btnExtenso.onclick = ()=>{
    const v = parseCurrencyBRL(document.getElementById('extensoValor').value);
    if(isNaN(v)){ alert('Informe um valor no formato brasileiro (ex.: 4.637,13)'); return; }
    document.getElementById('extensoSaida').value = moedaPorExtenso(v).replace(/\b\w/g, c=>c.toUpperCase());
  };
  btnCopyExtenso.onclick = async ()=> {
    await navigator.clipboard.writeText(document.getElementById('extensoSaida').value||'');
  };

  // --- CPF/CNPJ: validar e formatar ---
  function onlyDigits(s){ return (s||"").replace(/\D+/g,''); }
  function cpfValido(cpf){
    cpf = onlyDigits(cpf);
    if(cpf.length!==11 || /^(\d)\1+$/.test(cpf)) return false;
    let soma=0; for(let i=0;i<9;i++) soma+= parseInt(cpf[i])*(10-i);
    let d1 = (soma*10)%11; if(d1===10) d1=0;
    if(d1!=cpf[9]) return false;
    soma=0; for(let i=0;i<10;i++) soma+= parseInt(cpf[i])*(11-i);
    let d2=(soma*10)%11; if(d2===10) d2=0;
    return d2==cpf[10];
  }
  function cnpjValido(cnpj){
    cnpj = onlyDigits(cnpj);
    if(cnpj.length!==14 || /^(\d)\1+$/.test(cnpj)) return false;
    const pesos1=[5,4,3,2,9,8,7,6,5,4,3,2], pesos2=[6,5,4,3,2,9,8,7,6,5,4,3,2];
    let soma=0; for(let i=0;i<12;i++) soma+= parseInt(cnpj[i])*pesos1[i];
    let d1 = soma%11; d1 = d1<2?0:11-d1;
    soma=0; for(let i=0;i<13;i++) soma+= parseInt(cnpj[i])*pesos2[i];
    let d2 = soma%11; d2 = d2<2?0:11-d2;
    return d1==cnpj[12] && d2==cnpj[13];
  }
  function maskCPF(cpf){
    cpf = onlyDigits(cpf).padStart(11,'0').slice(-11);
    return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,'$1.$2.$3-$4');
  }
  function maskCNPJ(cnpj){
    cnpj = onlyDigits(cnpj).padStart(14,'0').slice(-14);
    return cnpj.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,'$1.$2.$3/$4-$5');
  }
  const btnValidarDoc = document.getElementById('btnValidarDoc');
  const btnMaskDoc = document.getElementById('btnMaskDoc');
  const btnCopyDoc = document.getElementById('btnCopyDoc');
  btnValidarDoc.onclick = ()=>{
    const raw = document.getElementById('docNumero').value;
    const d = onlyDigits(raw);
    if(!d){ alert('Informe um CPF ou CNPJ.'); return; }
    let valido=false, formatado="";
    if(d.length<=11){ valido = cpfValido(d); formatado = maskCPF(d); }
    else{ valido = cnpjValido(d); formatado = maskCNPJ(d); }
    document.getElementById('docSaida').value = `${formatado} ‚Äî ${valido? "V√ÅLIDO ‚úÖ":"INV√ÅLIDO ‚ùå"}`;
  };
  btnMaskDoc.onclick = ()=>{
    const d = onlyDigits(document.getElementById('docNumero').value);
    if(!d){ alert('Informe um CPF ou CNPJ.'); return; }
    document.getElementById('docSaida').value = (d.length<=11) ? maskCPF(d) : maskCNPJ(d);
  };
  btnCopyDoc.onclick = async ()=> {
    await navigator.clipboard.writeText(document.getElementById('docSaida').value||'');
  };

  // --- Qualifica√ß√£o r√°pida ---
  function qualificar(){
    const nome = (document.getElementById('qNome').value||'').trim();
    const cnh = (document.getElementById('qCNH').value||'').trim();
    const rg = (document.getElementById('qRG').value||'').trim();
    const cpf = onlyDigits(document.getElementById('qCPF').value||'');
    const end = (document.getElementById('qEndereco').value||'').trim();
    const ciduf = (document.getElementById('qCidadeUF').value||'').trim();
    const cep = (document.getElementById('qCEP').value||'').trim();
    const exp = (document.getElementById('qExpedicao').value||'').trim();

    if(!nome || !rg || !cpf || !end || !ciduf || !cep){
      alert('Preencha ao menos: Nome, RG, CPF, Endere√ßo, Cidade/UF e CEP.');
      return;
    }
    const cpfFmt = maskCPF(cpf);
    let partes = [];
    partes.push(`${nome}, portador${nome.endsWith('a')?'a':''} ${cnh?`da CNH n¬∞ ${cnh}, `:''}na qual consta a C√©dula de Identidade RG n¬∫ ${rg}, inscrito no CPF/MF n¬∫ ${cpfFmt}${exp?`, expedido em ${exp}`:''}, residente e domiciliad${nome.endsWith('a')?'a':'o'} na ${end}, ${ciduf}, CEP ${cep}.`);
    document.getElementById('qualifSaida').value = partes.join(' ');
  }
  document.getElementById('btnQualificar').onclick = qualificar;
  document.getElementById('btnCopyQualif').onclick = async ()=> {
    await navigator.clipboard.writeText(document.getElementById('qualifSaida').value||'');
  };

  // --- Prazo em dias √∫teis ---
  function parseHolidayList(str){
    return (str||"").split(',').map(s=>s.trim()).filter(Boolean)
      .map(s=> new Date(s+'T00:00:00'));
  }
  function isSameDate(a,b){ return a.getFullYear()==b.getFullYear() && a.getMonth()==b.getMonth() && a.getDate()==b.getDate(); }
  function addBusinessDays(start, days, holidays){
    const d = new Date(start.getTime()); let count=0;
    while(count < days){
      d.setDate(d.getDate()+1);
      const wd = d.getDay(); // 0 dom .. 6 sab
      const feriado = holidays.some(h=> isSameDate(h,d));
      if(wd!==0 && wd!==6 && !feriado) count++;
    }
    return d;
  }
  function businessDaysBetween(start,end,holidays){
    // conta √∫teis exclusivos da data inicial, inclusivos na final se √∫til
    let d = new Date(start.getTime()); let c=0;
    while(d < end){
      d.setDate(d.getDate()+1);
      const wd = d.getDay();
      const feriado = holidays.some(h=> isSameDate(h,d));
      if(wd!==0 && wd!==6 && !feriado) c++;
    }
    return c;
  }
  const btnPrazo = document.getElementById('btnPrazo');
  const btnCopyPrazo = document.getElementById('btnCopyPrazo');
  btnPrazo.onclick = ()=>{
    const di = document.getElementById('pDataIni').value;
    const qtd = parseInt(document.getElementById('pDias').value||'0',10);
    if(!di || isNaN(qtd)){ alert('Informe data inicial e quantidade de dias √∫teis.'); return; }
    const fer = parseHolidayList(document.getElementById('pFeriados').value);
    const ini = new Date(di+'T00:00:00');
    const fim = addBusinessDays(ini, qtd, fer);
    const uteis = businessDaysBetween(ini, fim, fer);
    document.getElementById('prazoSaida').value = `In√≠cio: ${ini.toLocaleDateString()} | Prazo: ${qtd} dias √∫teis | T√©rmino: ${fim.toLocaleDateString()} | √öteis contados: ${uteis}`;
  };
  btnCopyPrazo.onclick = async ()=> {
    await navigator.clipboard.writeText(document.getElementById('prazoSaida').value||'');
  };

  // --- Modelos r√°pidos (com prefer√™ncias do cart√≥rio) ---
  function modeloTexto(tipo, nome){
    const saud = nome? `Ol√°, ${nome}!` : `Ol√°, tudo bem?`;
    const fechamento = "Atenciosamente, Cart√≥rio Vila S√£o Pedro | Dourados-MS üöÄ";
    const lembretePix = "Obs.: Pagamento **preferencialmente via PIX pelo QR Code do boleto**.";
    if(tipo==='docs'){
      return `${saud}\n\nPara darmos andamento, pedimos a gentileza de nos enviar a documenta√ß√£o atualizada (certid√£o simplificada em at√© 30 dias, contrato/altera√ß√£o vigente e documento do s√≥cio administrador, quando houver).\n\n${lembretePix}\n\n${fechamento}`;
    }
    if(tipo==='cobranca'){
      return `${saud}\n\nSegue cobran√ßa referente ao servi√ßo solicitado. ${lembretePix}\n\nChave PIX (exemplo): financeiro@cartoriodourados.com\n\nAp√≥s o pagamento, por favor envie o comprovante para agilizarmos o processo.\n\n${fechamento}`;
    }
    if(tipo==='matriculaOnr'){
      return `${saud}\n\nSolicitaremos a matr√≠cula atualizada pela ONR, com pagamento via PIX imediato. Caso prefira, podemos contatar o cliente para que ele mesmo realize o pagamento.\n\n${lembretePix}\n\n${fechamento}`;
    }
    // cnd iptu
    return `${saud}\n\nA CND/IPTU do im√≥vel consta **positiva**. Isso pode ocorrer por d√©bitos em aberto, parcelas vencidas ou atualiza√ß√£o pendente no sistema municipal. Para prosseguirmos com a lavratura, √© necess√°rio regularizar a pend√™ncia e nos encaminhar a certid√£o negativa/positiva com efeito de negativa.\n\n${fechamento}`;
  }
  document.getElementById('btnModelo').onclick = ()=>{
    const tipo = document.getElementById('modeloTipo').value;
    const nome = document.getElementById('modeloNome').value.trim();
    document.getElementById('modeloSaida').value = modeloTexto(tipo, nome);
  };
  document.getElementById('btnCopyModelo').onclick = async ()=> {
    await navigator.clipboard.writeText(document.getElementById('modeloSaida').value||'');
  };
</script>
</body>
</html>
